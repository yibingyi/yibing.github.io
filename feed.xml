<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Work Life</title>
    <description>å­¦ä¹  åˆ†äº« åšæŒ</description>
    <link>https://yibingyi.github.io/</link>
    <atom:link href="https://yibingyi.github.io/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Sun, 18 Jun 2017 18:49:34 +0800</pubDate>
    <lastBuildDate>Sun, 18 Jun 2017 18:49:34 +0800</lastBuildDate>
    <generator>Jekyll v3.4.3</generator>
    
      <item>
        <title>expect shell auto ssh</title>
        <description>&lt;p&gt;å…ˆè¯´è¯´èƒŒæ™¯ï¼Œåœ¨ç°åœ¨çš„å·¥ä½œç¯å¢ƒä¸­ï¼Œæ¯æ¬¡éœ€è¦ç™»é™†çº¿ä¸Šæœºå™¨çš„æ—¶å€™ï¼Œç¬¬ä¸€æ­¥éœ€è¦åˆ°å ¡å’æœº[PIN+Token]ï¼Œç¬¬äºŒæ­¥åœ¨ç™»é™†åˆ°ä¸­æ§æœºï¼Œå¹¶ä¸”éœ€è¦å®Œæˆè§’è‰²åˆ‡æ¢ç­‰æ“ä½œï¼Œæ¯”è¾ƒç¹çï¼Œäºæ˜¯æƒ³åˆ°æ˜¯å¦èƒ½è‡ªåŠ¨å®Œæˆå‘¢ï¼Ÿäºæ˜¯å‘ç°äº†expectè¿™ä¸ªä¸œè¥¿ï¼å¾ˆæƒŠå–œï¼ï¼ˆè¯·åŸè°…å°ç™½çš„æ— çŸ¥ï¼‰&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;å…ˆè¯´è¯´ä»€ä¹ˆæ˜¯&lt;a href=&quot;http://linuxcommand.org/man_pages/expect1.html&quot;&gt;expect shell?&lt;/a&gt;&lt;/strong&gt; &lt;br /&gt;
 å®˜æ–¹è§£é‡Šä¸ºï¼Œä¸€ç§ç”¨æ¥å’Œåº”ç”¨ç¨‹åºäº¤äº’çš„è„šæœ¬ï¼Œä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸‹expectè„šæœ¬çš„ç®€å•ä¾‹å­ï¼Œé¦–å…ˆè¦æ˜ç™½expectä¸æ˜¯bashçš„ä¸€ä¸ªå‘½ä»¤ï¼Œå®ƒä¹Ÿæ˜¯ä¸€ç§shellï¼Œæ²¡æœ‰å®‰è£…è¿‡ï¼Œç‚¹å‡»&lt;a href=&quot;http://expect.sourceforge.net/&quot;&gt;å®‰è£…Expect&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;SSHåˆçª¥Expect Shell&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# è¿™ä¸€è¡Œå‘Šè¯‰æ“ä½œç³»ç»Ÿè„šæœ¬é‡Œçš„ä»£ç ä½¿ç”¨é‚£ä¸€ä¸ªshellæ¥æ‰§è¡Œã€‚ç±»æ¯”bash&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#!/usr/bin/expect&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# è®¾ç½®å˜é‡&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;name map
&lt;span class=&quot;c&quot;&gt;# expect shell if&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;root&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    puts &lt;span class=&quot;s2&quot;&gt;&quot;WRRN: you will login as root;&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# spawn æ˜¯expect shellçš„ä¸€ä¸ªå‘½ä»¤ ç”¨æ¥å‘èµ·ä¸€ä¸ªäº¤äº’åŠ¨ä½œ æ¯”å¦‚ç°åœ¨å°±æ˜¯åœ¨è¿›è¡Œä¸€æ¬¡ssh&lt;/span&gt;
spawn ssh &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;@host.name
&lt;span class=&quot;c&quot;&gt;# æ­¤å¤„expecté’ˆå¯¹spawnæ‰§è¡ŒåŠ¨ä½œçš„è¿”å›å€¼åšä¸åŒçš„æ“ä½œ&lt;/span&gt;
expect &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# å¦‚æœè¿”å›çš„å­—ç¬¦ä¸²åŒ…å«(yes/no)&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&quot;(yes/no)?&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;# å‘é€yeså¹¶å›è½¦ ç›¸å½“äºæˆ‘ä»¬åœ¨terminalä¸­è¾“å…¥äº†yeså¹¶å›è½¦&lt;/span&gt;
        send &lt;span class=&quot;s2&quot;&gt;&quot;yes&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;# å¦‚æœè¿”å›çš„å­—ç¬¦ä¸²åŒ…å«password&lt;/span&gt;
        expect &lt;span class=&quot;s2&quot;&gt;&quot;password:&quot;&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;# å‘é€pwdTokenå¹¶å›è½¦ ç›¸å½“äºæˆ‘ä»¬åœ¨terminalä¸­è¾“å…¥äº†pwdTokenå¹¶å›è½¦&lt;/span&gt;
        send &lt;span class=&quot;s2&quot;&gt;&quot;pwdToken&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# åŒç† ä¸èµ˜è¿°&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&quot;password:&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;c&quot;&gt;# å‘å‡ºè¯·æ±‚è®©ç”¨æˆ·è¾“å…¥&lt;/span&gt;
            send_user &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;33&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;4;34m please input otp password : &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;33&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;0m &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
            &lt;span class=&quot;c&quot;&gt;# æ¥æ”¶ç”¨æˆ·æŒ‰ä¸‹å›è½¦é”®ä¹‹å‰è¾“å…¥çš„æ‰€æœ‰å­—ç¬¦&lt;/span&gt;
            expect_user -re &lt;span class=&quot;s2&quot;&gt;&quot;(.*)&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
            &lt;span class=&quot;c&quot;&gt;# å°†1111å’Œç”¨æˆ·è¾“å…¥æ‹¼æ¥èµ‹å€¼ç»™å˜é‡pwdToken&lt;/span&gt;
            &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;pwdToken 1111&lt;span class=&quot;nv&quot;&gt;$expect_out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1,string&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
            send &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$pwdToken&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# expect æ‰§è¡Œå®Œæˆ å°†æ§åˆ¶æƒäº¤å›ç»™ç»ˆç«¯&lt;/span&gt;
interact

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;trcks&lt;/strong&gt;
å¦‚æœåœ¨ç¼–å†™expectè„šæœ¬çš„æ—¶å€™é‡åˆ°äº†é—®é¢˜ï¼Œå¯ä»¥è¾“å…¥å‘½ä»¤&lt;code class=&quot;highlighter-rouge&quot;&gt;expect&lt;/code&gt;è¿›è¡Œè°ƒè¯•&lt;/p&gt;
&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;âœ  GitHub expect
&lt;span class=&quot;gp&quot;&gt;expect1.1&amp;gt; &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;name china
china
&lt;span class=&quot;gp&quot;&gt;expect1.2&amp;gt; &lt;/span&gt;puts &lt;span class=&quot;nv&quot;&gt;$name&lt;/span&gt;
china
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
</description>
        <pubDate>Fri, 16 Jun 2017 23:00:00 +0800</pubDate>
        <link>https://yibingyi.github.io/learn/shell/2017/06/16/learn-expect.html</link>
        <guid isPermaLink="true">https://yibingyi.github.io/learn/shell/2017/06/16/learn-expect.html</guid>
        
        
        <category>learn</category>
        
        <category>shell</category>
        
      </item>
    
      <item>
        <title>shellå­¦ä¹ ç¬”è®°-åŸºç¡€çŸ¥è¯†ï¼ˆä¸€ï¼‰</title>
        <description>&lt;p&gt;&lt;strong&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;|&lt;/code&gt; ç®¡é“ç¬¦&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#å°†å‰ä¸€ä¸ªå‘½ä»¤ä½œä¸ºåä¸€ä¸ªå‘½ä»¤çš„è¾“å…¥&lt;/span&gt;
cat &amp;gt; t
who | wc -l  &lt;span class=&quot;c&quot;&gt;#crtl+d&lt;/span&gt;
chmod +x t	
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;#!&lt;/code&gt; æŒ‡å®šå¤„ç†è„šæœ¬æ‰€éœ€çš„shellï¼Œå¸¸è§shellæœ‰bashï¼Œè¿˜æœ‰expectæ­¤ç±»ä¸å¸¸è§çš„shell&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;%s&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\t\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; china
&lt;span class=&quot;c&quot;&gt;# è¾“å‡º china &lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;IO&lt;/code&gt;é‡å®šå‘&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# crtll+D æ–‡ä»¶ç»“å°¾&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# program &amp;gt; file å¯å°†programçš„æ ‡å‡†è¾“å‡ºä¿®æ”¹ä¸ºfile&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#  å°†dos-file.txtä¸­çš„å›è½¦ç¬¦åˆ é™¤ï¼›å¹¶å°†ç»“æœè¾“å‡ºçš„UNIX-file.txt æ”¹å˜æ ‡å‡†è¾“å…¥å’Œè¾“å‡º&lt;/span&gt;
tr -d &lt;span class=&quot;s1&quot;&gt;'\r'&lt;/span&gt; &amp;lt; dos-file.txt &amp;gt; UNIX-file.txt 
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;gt;&lt;/code&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt; é‡å®šå‘ç¬¦å· &lt;/code&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;gt;&amp;gt;&lt;/code&gt;` å°†æ ‡å‡†è¾“å‡ºé™„ä»¶åˆ°é—®ä»·ç»“å°¾ä¹‹å&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# å°†æ‰€æœ‰ä»¥dos-fileå¼€å¤´çš„ï¼Œä»¥.txtç»“å°¾çš„æ–‡ä»¶ä¸­æ‰€æœ‰çš„æ¢è¡Œç¬¦åˆ é™¤å¹¶è¾“å‡ºåˆ°big-UNIX-file.txt&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;f &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;dos-file&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;.txt
&lt;span class=&quot;k&quot;&gt;do 
&lt;/span&gt;tr -d &lt;span class=&quot;s1&quot;&gt;'\r'&lt;/span&gt; &amp;lt; &lt;span class=&quot;nv&quot;&gt;$f&lt;/span&gt; &amp;gt;&amp;gt; big-UNIX-file.txt
&lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;| å»ºç«‹ç®¡é“  ä½¿ç”¨ç®¡é“æ¯”ä½¿ç”¨ä¸´æ—¶æ–‡ä»¶çš„é€Ÿåº¦å¿«çš„å¤š!&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# å°†p1çš„æ ‡å‡†è¾“å‡ºä½œä¸ºp2çš„æ ‡å‡†è¾“å…¥&lt;/span&gt;
p1 | p2 
&lt;span class=&quot;c&quot;&gt;# å…ˆåˆ é™¤æ–‡ä»¶ä¸­çš„å›è½¦ç¬¦ ç„¶åå®Œæˆæ•°æ®çš„æ’åº æœ€åè¾“å‡ºåˆ°æ–‡ä»¶&lt;/span&gt;
tr -d &lt;span class=&quot;s1&quot;&gt;'\r'&lt;/span&gt; &amp;lt; dos-file.txt | sort &amp;gt; UNINX-file.txt
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;$PATH&lt;/code&gt; linux ä¼šæ²¿ç€pathå»æŸ¥æ‰¾å‘½ä»¤&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;PATH
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ~
mkdir bin
mv user bin
&lt;span class=&quot;nv&quot;&gt;PATH&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$PATH&lt;/span&gt;:&lt;span class=&quot;nv&quot;&gt;$HOME&lt;/span&gt;/bin
user &lt;span class=&quot;c&quot;&gt;# è¢«shell å‘ç°å¹¶æ‰§è¡Œ&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;## æœŸæœ›è¾“å‡º userçš„æ ‡å‡†è¾“å‡º &lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;shell å‚æ•°&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# å°†å‘½ä»¤è¡Œçš„æ ‡å‡†è¾“å…¥è¾“å‡ºåˆ°æ–‡ä»¶finduser&lt;/span&gt;
cat &amp;gt; finduser

&lt;span class=&quot;c&quot;&gt;#ï¼ /bin/sh&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# finduser æŸ¥çœ‹ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šçš„ç”¨æˆ·æ˜¯å¦ç™»é™†&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# å½“å‚æ•°åˆ—è¡¨å¤šä»¥9ä¸ªçš„æ—¶å€™ éœ€ä½¿ç”¨{} eg. ${10}&lt;/span&gt;
who | grep &lt;span class=&quot;nv&quot;&gt;$1&lt;/span&gt; 

chmod +x finduser &lt;span class=&quot;c&quot;&gt;# ä¸ºfinduseræ·»åŠ å¯æ‰§è¡Œæƒé™&lt;/span&gt;

./finduser yibing
&lt;span class=&quot;c&quot;&gt;# æœŸæœ›è¾“å‡º yibing æ˜¯å¦ç™»é™†  &lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;æ‰§è¡Œè·Ÿè¸ª&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;executing tracing [ä½¿shellæ˜¾ç¤ºæ¯ä¸ªè¢«æ‰§è¡Œçš„å‘½ä»¤]&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;cat tracel.sh
&lt;span class=&quot;c&quot;&gt;#! /bin/sh&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt; -x &lt;span class=&quot;c&quot;&gt;# æ‰“å¼€è·Ÿè¸ª&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;1st &lt;span class=&quot;nb&quot;&gt;echo
set&lt;/span&gt; +x &lt;span class=&quot;c&quot;&gt;# å…³é—­è·Ÿè¸ª&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;2st &lt;span class=&quot;nb&quot;&gt;echo
&lt;/span&gt;crtl+D

chmod +x tracel.sh
./tracel.sh 

&lt;span class=&quot;c&quot;&gt;# é¢„æœŸè¾“å‡º&lt;/span&gt;
+ &lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;1st &lt;span class=&quot;nb&quot;&gt;echo
&lt;/span&gt;1st &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt;
+ &lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt; +x
2nd &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
</description>
        <pubDate>Fri, 16 Jun 2017 19:00:00 +0800</pubDate>
        <link>https://yibingyi.github.io/learn/shell/2017/06/16/learn-shell.html</link>
        <guid isPermaLink="true">https://yibingyi.github.io/learn/shell/2017/06/16/learn-shell.html</guid>
        
        
        <category>learn</category>
        
        <category>shell</category>
        
      </item>
    
      <item>
        <title>shellå­¦ä¹ ç¬”è®°-æ–‡æœ¬æ“ä½œï¼ˆäºŒï¼‰</title>
        <description>&lt;p&gt;&lt;strong&gt;åˆè¯†sed&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;æ­£åˆ™ &lt;code class=&quot;highlighter-rouge&quot;&gt;^&lt;/code&gt; åŒ¹é…ç´§æ¥çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œåœ¨è¡Œæˆ–å­—ç¬¦ä¸²çš„èµ·å§‹å¤„ 
&lt;code class=&quot;highlighter-rouge&quot;&gt;$&lt;/code&gt; åŒ¹é…å‰é¢çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œåœ¨å­—ç¬¦ä¸²çš„æœ«å°¾æ´»ç€è¡Œçš„ç»“æŸ&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sed &lt;span class=&quot;s1&quot;&gt;'s/:.*//'&lt;/span&gt; /etc/passwd | sort -u 
&lt;span class=&quot;c&quot;&gt;#åˆ é™¤ç¬¬ä¸€ä¸ªå†’å·ä¹‹åçš„æ‰€æœ‰ä¸œè¥¿ï¼Œå¹¶æ’åºåˆ—è¡¨åˆ é™¤é‡å¤éƒ¨åˆ†&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# æ‰“å°æ­¤ç›®å½•ä¸‹çš„æ–‡ä»¶åˆ—è¡¨&lt;/span&gt;
find /home/tolstoy -type d -print 
 &lt;span class=&quot;c&quot;&gt;# æ›¿æ¢æ–‡ä»¶è·¯å¾„&lt;/span&gt;
sed &lt;span class=&quot;s1&quot;&gt;'s;/home/tolstoy/;/home/lt/;'&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# sedæ·»åŠ mkdir&lt;/span&gt;
    sed &lt;span class=&quot;s1&quot;&gt;'s/^/mkdir /'&lt;/span&gt; 
        &lt;span class=&quot;c&quot;&gt;# shellæ‰§è¡Œ&lt;/span&gt;
        sh -x 
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;sedæ›¿æ¢ç»†èŠ‚&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;é™¤äº†æ–œæ ä¹‹å¤–è¿˜å¯ä»¥ä½¿ç”¨å…¶ä»–ç¬¦å·æ¥ä½œä¸ºå®šç•Œç¬¦&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# è‹¥åªèƒ½ä½¿ç”¨ â€˜/â€™ ä½œä¸ºå®šç•Œç¬¦çš„æ—¶å€™ ä¼šå¯¼è‡´å‘½ä»¤ä¸æ˜“è¯»&lt;/span&gt;
sed &lt;span class=&quot;s1&quot;&gt;'s/\/home\/tolstoy\//\/home\/lt\//'&lt;/span&gt; 
&lt;span class=&quot;c&quot;&gt;# æ›¿æ¢æ–‡ä»¶è·¯å¾„ ç”¨ â€˜;â€™ ä½œä¸ºå®šç•Œç¬¦ å‘½ä»¤å˜å¾—æ¸…æ™°&lt;/span&gt;
sed &lt;span class=&quot;s1&quot;&gt;'s;/home/tolstoy/;/home/lt/;'&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;åœ¨sedä¸­ &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;amp;&lt;/code&gt; ç”¨äºåŒ¹é…â€œä»æ­¤ç‚¹å¼€å§‹æ›¿ä»£æˆåŒ¹é…ä¸æ•´ä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„æ•´ä¸ªæ–‡æœ¬&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sed &lt;span class=&quot;s1&quot;&gt;'s/ata/&amp;amp;, the capital of the south/'&lt;/span&gt;  myfile.txt
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;åœ¨sedä¸­ï¼Œ så‘½ä»¤é‡Œä»¥&lt;code class=&quot;highlighter-rouge&quot;&gt;g&lt;/code&gt;ç»“å°¾è¡¨ç¤ºå…¨å±€æ›¿æ¢ ä¸ç„¶åªä¼šæ›¿ä»£åŒ¹é…åˆ°çš„ç¬¬ä¸€ä¸ª&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sed &lt;span class=&quot;s1&quot;&gt;'s/toy/weapon/g'&lt;/span&gt; myfile.txt &lt;span class=&quot;c&quot;&gt;# å…¨å±€æ›¿æ¢&lt;/span&gt;
sed &lt;span class=&quot;s1&quot;&gt;'s/toy/weapon/'&lt;/span&gt;  myfile.txt &lt;span class=&quot;c&quot;&gt;# å•ç‹¬æ›¿æ¢&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;é€šè¿‡ç®¡é“å¯ä»¥å°†sedå®ä½“ä¸²è”èµ·æ¥ ï¼Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;-e&lt;/code&gt; é€‰é¡¹&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;sed -e &lt;span class=&quot;s1&quot;&gt;'s/foo/bar/g'&lt;/span&gt; -e &lt;span class=&quot;s1&quot;&gt;'s/chicken/cow/g'&lt;/span&gt; myfile.txt &lt;span class=&quot;c&quot;&gt;# ç¬¬ä¸€ç§&lt;/span&gt;

cat &amp;gt; fixup.sed
s/foo/bar/g
s/chicken/cow/g
s/china/america/g
myfile.txt
crtl+D

sed -f fixup.sed myfile.txt &lt;span class=&quot;c&quot;&gt;# ç¬¬äºŒç§&lt;/span&gt;

sed -f fixup.sed -e &lt;span class=&quot;s1&quot;&gt;'s/man/women/g'&lt;/span&gt; myfile.txt &lt;span class=&quot;c&quot;&gt;# ç¬¬ä¸‰ç§&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;åŒ¹é…ç‰¹å®šè¡Œ&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;,&lt;/code&gt; èŒƒå›´è¡¨è¾¾å¼  &lt;code class=&quot;highlighter-rouge&quot;&gt;!&lt;/code&gt; å¦å®šæ­£åˆ™è¡¨è¾¾å¼&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# æ‰“å°å«æœ‰htmlæ ‡ç­¾çš„è¡Œ&lt;/span&gt;
sed -n &lt;span class=&quot;s1&quot;&gt;'/&amp;lt;HTML&amp;gt;/p'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;.html 
&lt;span class=&quot;c&quot;&gt;# ç”¨â€˜,â€™ è¡¨ç¤ºè¡ŒèŒƒå›´&lt;/span&gt;
sed -n &lt;span class=&quot;s1&quot;&gt;'10,40p'&lt;/span&gt; foo.txt 
&lt;span class=&quot;c&quot;&gt;# åœ¨å·²fooå¼€å§‹ï¼Œbarç»“æŸçš„è¡Œä¸­è¿›è¡Œæ›¿æ¢&lt;/span&gt;
sed &lt;span class=&quot;s1&quot;&gt;'/foo/,/bar/ s/baz/quux/g'&lt;/span&gt; foo.xml 
&lt;span class=&quot;c&quot;&gt;# å°†æ²¡æœ‰usedè¡Œä¸­çš„newæ›¿æ¢ä¸ºused&lt;/span&gt;
sed /used/ !s/new/used/g 
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
</description>
        <pubDate>Fri, 16 Jun 2017 19:00:00 +0800</pubDate>
        <link>https://yibingyi.github.io/learn/shell/2017/06/16/learn-shell-1.html</link>
        <guid isPermaLink="true">https://yibingyi.github.io/learn/shell/2017/06/16/learn-shell-1.html</guid>
        
        
        <category>learn</category>
        
        <category>shell</category>
        
      </item>
    
      <item>
        <title>disqus è¢«å¢™äº†</title>
        <description>&lt;h4 id=&quot;å…³äºæ­¤åšå®¢çš„è¯„è®ºæ¡†å·¥å…·ç®€å•è¯´ä¸‹æˆ‘çš„å¿ƒè·¯å†ç¨‹&quot;&gt;å…³äºæ­¤åšå®¢çš„è¯„è®ºæ¡†å·¥å…·ç®€å•è¯´ä¸‹æˆ‘çš„å¿ƒè·¯å†ç¨‹&lt;/h4&gt;

&lt;p&gt;step1: å¾ˆå¼€å¿ƒçš„å®Œæˆäº†&lt;code class=&quot;highlighter-rouge&quot;&gt;disqus&lt;/code&gt;çš„é…ç½®å’Œéƒ¨ç½²&lt;br /&gt;
step2: å‘ç°è¢«å¢™äº†ï¼Œ(ãƒ¼ãƒ¼ã‚›)ä¸å¼€å¿ƒ&lt;br /&gt;
step3: æ‰¾æ›¿ä»£æ–¹æ¡ˆï¼Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;æœ‰è¨€&lt;/code&gt;ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;ç•…è¨€&lt;/code&gt;ï¼Œå¥½ä¸‘ï¼Œå¹¶ä¸”&lt;code class=&quot;highlighter-rouge&quot;&gt;æœ‰è¨€&lt;/code&gt;ä¸æ”¯æŒhttps&lt;br /&gt;
step4: å›å½’&lt;code class=&quot;highlighter-rouge&quot;&gt;disqus&lt;/code&gt;ï¼Œé‡‡ç”¨æ‡’åŠ è½½çš„æ–¹å¼&lt;br /&gt;
step5: å¿ƒå¥½ç´¯ğŸ’”&lt;/p&gt;
</description>
        <pubDate>Fri, 16 Jun 2017 19:00:00 +0800</pubDate>
        <link>https://yibingyi.github.io/tool/2017/06/16/learn-first.html</link>
        <guid isPermaLink="true">https://yibingyi.github.io/tool/2017/06/16/learn-first.html</guid>
        
        
        <category>tool</category>
        
      </item>
    
      <item>
        <title>äººè§äººçˆ±Kibana</title>
        <description>&lt;p&gt;kibannaä¸€ä¸ªå…·æœ‰ç‚«é…·å¤–è§‚çš„ElasticSearchå®¢æˆ·ç«¯ï¼Œå›¾å½¢åŒ–æ•°æ®åŠŸèƒ½å¼ºå¤§ï¼Œ
å†…ç½®å¼€å‘consoleï¼Œä¾¿æ·ç®¡ç†å’Œåˆ†ææ•°æ®çš„åˆ©å™¨&lt;/p&gt;
</description>
        <pubDate>Fri, 16 Jun 2017 19:00:00 +0800</pubDate>
        <link>https://yibingyi.github.io/tool/2017/06/16/elk-kibana.html</link>
        <guid isPermaLink="true">https://yibingyi.github.io/tool/2017/06/16/elk-kibana.html</guid>
        
        
        <category>tool</category>
        
      </item>
    
      <item>
        <title>ä»çˆ¬è™«åˆ°ELK</title>
        <description>&lt;p&gt;æœ‰å¤©ï¼Œçªç„¶å¿ƒè¡€æ¥æ½®ï¼ŒæŠ“äº†ä¸€äº›æ•°æ®ã€‚å—¯ï¼Œæ•°æ®å·²ç»æŠ“å›æ¥äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•æœ‰æ•ˆçš„åˆ©ç”¨å‘¢ï¼Ÿ
æ˜¯æ—¶å€™ç¥­å‡ºELKäº†ã€‚&lt;/p&gt;

&lt;p&gt;å‰é¢è¯´äº†ï¼Œæ˜¯å¿ƒè¡€æ¥æ½®ï¼Œä¸€æ—¶ä¹‹é—´ä¸çŸ¥é“æŠ“ç‚¹ä»€ä¹ˆæ•°æ®ï¼Œäºæ˜¯æŒ‘äº†ä¸€ä¸ªå¥½æŠ“çš„ï¼Œè¿˜æœ‰å¤§å®¶æ¯”è¾ƒå…³å¿ƒçš„æ•°æ®
ï¼Œå¥½å§ï¼Œæ‹‰å‹¾ï¼Œæˆ‘æ¥äº†ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;æ•°æ®æ¥å£&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;http://www.lagou.com/jobs/positionAjax.json
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;æ¥å£è¿”å›å€¼&lt;/p&gt;
&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;companyId&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;68190&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;positionId&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3240815&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;positionName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;SEO/SEMç»ç†&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;createTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;2017-06-18 17:58:53&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;positionAdvantage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Bè½®ä¼ä¸š,æˆç†Ÿäº§å“,æœ‰çˆ±æ–‡åŒ–&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;salary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;8k-16k&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;workYear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;ä¸é™&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;education&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;ä¸é™&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;city&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;åŒ—äº¬&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;companyLogo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;image1/M00/2B/B2/CgYXBlVxHJqAI6j5AABaKUwNZFQ142.jpg&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;jobNature&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;å…¨èŒ&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;approve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;industryField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;æ•™è‚²&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;companyShortName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;æ¢¦è…¾ç§‘æŠ€åŒ—äº¬æ€»éƒ¨&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;financeStage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;æˆé•¿å‹(Bè½®)&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;positionLables&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:[],&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;industryLables&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:[],&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;companySize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;50-150äºº&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;district&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;companyLabelList&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&quot;å¹´åº•åŒè–ª&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&quot;æŠ€èƒ½åŸ¹è®­&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&quot;ç»©æ•ˆå¥–é‡‘&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&quot;å²—ä½æ™‹å‡&quot;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;formatCreateTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;17:58å‘å¸ƒ&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;businessZones&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;imState&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;today&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;lastLogin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1497779372000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;publisherId&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1662895&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;explain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;plus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;pcShow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;appShow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;deliver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;gradeDescription&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;promotionScoreExplain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;firstType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;å¸‚åœº/å•†åŠ¡/é”€å”®ç±»&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;secondType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;æ¸ é“/æ¨å¹¿&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;companyFullName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;ä¸Šæµ·æ¢¦è…¾å•†åŠ¡ä¿¡æ¯å’¨è¯¢æœ‰é™å…¬å¸&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;adWord&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;ç”±äºæ˜¯æ ‡å‡†çš„jsonè¿”å›å€¼ï¼Œè§£æåŸºæœ¬æ²¡æœ‰æˆæœ¬ã€‚é‡‡ç”¨ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€&lt;code class=&quot;highlighter-rouge&quot;&gt;PHP&lt;/code&gt;è¿›è¡ŒæŠ“å–ï¼Œ
crontabåšå®šæ—¶ä»»åŠ¡ï¼Œæ¯å°æ—¶æŠ“å–ä¸€æ¬¡&lt;/p&gt;

&lt;p&gt;PHPæŠ“å–ä»£ç ç¤ºä¾‹&lt;/p&gt;

&lt;p&gt;æ¥å£å¯ä»¥æ¥å—å‚æ•°è¿›è¡Œç­›é€‰ï¼Œæˆ‘ä½¿ç”¨çš„æœ‰&lt;code class=&quot;highlighter-rouge&quot;&gt;kd&lt;/code&gt;ç­›é€‰è¯ï¼Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;pn&lt;/code&gt;ç­›é€‰ç»“æœé¡µé¢ç¼–å·
&lt;code class=&quot;highlighter-rouge&quot;&gt;city&lt;/code&gt;åŸå¸‚ç­›é€‰é¡¹&lt;/p&gt;
&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;do {
    // å‚æ•°æ•°ç»„
    $data = ['kd' =&amp;gt; $kd, 'pn' =&amp;gt; $pn, 'city' =&amp;gt; $city];
    $res = curl_lagou($url, $data);
    $res = json_decode($res, true);
   
    foreach ($res['content']['positionResult']['result'] as $item) {
        $resElk = [];
        $resElk['position_id'] = $item['positionId'];
        $resElk['experice']    = $item['workYear'];
        // å†™å…¥æ–‡ä»¶
        $resElk = implode(&quot;||&quot;, $resElk);
        $resElk = $resElk . &quot;\n&quot;;
        // æ’å…¥æ•°æ®åº“
        insert($tableName, $resElk);
        file_put_contents('/Users/linus/Document/lagou/lagou.log', $resElk, FILE_APPEND);
    }
    $pn++;
} while ($pn &lt;span class=&quot;err&quot;&gt;&amp;lt;&lt;/span&gt;= 400);

function curl_lagou($url, $data) {
    $ip = gen_ip();
    $ch = curl_init();
    $header = array(
        &quot;CLIENT-IP:{$ip}&quot;,
        &quot;X-FORWARDED-FOR:{$ip}&quot;,
    );
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_HTTPHEADER, $header);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER,true);
    curl_setopt($ch, CURLOPT_POST, true);
    curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query($data));

    $page_content = curl_exec($ch);
    if($error=curl_error($ch)){
        die($error);
    }
    curl_close($ch);
    return $page_content;
}

// ç”ŸæˆIP æ© long2ipè¿˜æ˜¯å¾ˆå¥½ä½¿ é˜²æ­¢è¯·æ±‚è¢«ä¸¢å¼ƒ
function gen_ip() {
    $ip_long = array(
        array('607649792', '608174079'), //36.56.0.0-36.63.255.255
        array('1038614528', '1039007743'), //61.232.0.0-61.237.255.255
        array('1783627776', '1784676351'), //106.80.0.0-106.95.255.255
        array('2035023872', '2035154943'), //121.76.0.0-121.77.255.255
        array('2078801920', '2079064063'), //123.232.0.0-123.235.255.255
        array('-1950089216', '-1948778497'), //139.196.0.0-139.215.255.255
        array('-1425539072', '-1425014785'), //171.8.0.0-171.15.255.255
        array('-1236271104', '-1235419137'), //182.80.0.0-182.92.255.255
        array('-770113536', '-768606209'), //210.25.0.0-210.47.255.255
        array('-569376768', '-564133889'), //222.16.0.0-222.95.255.255
    );
    $rand_key = mt_rand(0, 9);
    $ip= long2ip(mt_rand($ip_long[$rand_key][0], $ip_long[$rand_key][1]));
    return $ip;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;ä¹‹å‰æ²¡æœ‰æƒ³åˆ°è¦ä½œåˆ†æï¼Œçº¯ç²¹æŠ“æ¥å›¾ä¸ªä¹ï¼ï¼ˆæˆ‘æ˜¯æœ‰å¤šé—²!ï¼‰ï¼Œæ‰€ä»¥æ‰“ç®—ç”¨&lt;code class=&quot;highlighter-rouge&quot;&gt;Mysql&lt;/code&gt;è¿›è¡Œå­˜å‚¨ã€‚è¿™æ˜¯å½“æ—¶ç”¨çš„è¡¨&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-mysql&quot;&gt;CREATE TABLE `lagou_position` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
  `position_id` bigint(20) NOT NULL,
  `position` varchar(64) NOT NULL DEFAULT '',
  `position_label` varchar(128) NOT NULL DEFAULT '',
  `salary` varchar(64) NOT NULL DEFAULT '0',
  `company` varchar(128) NOT NULL DEFAULT '',
  `company_logo` varchar(256) NOT NULL DEFAULT '',
  `company_stage` varchar(64) NOT NULL DEFAULT '',
  `advantage` varchar(64) NOT NULL DEFAULT '',
  `experience` varchar(128) NOT NULL DEFAULT '',
  `education` varchar(64) NOT NULL DEFAULT '',
  `city` varchar(32) NOT NULL DEFAULT '',
  `industry` varchar(128) NOT NULL DEFAULT '',
  `company_size` varchar(64) NOT NULL DEFAULT '',
  `search` varchar(32) NOT NULL DEFAULT '',
  `create_time` datetime NOT NULL,
  `insert_time` datetime NOT NULL,
  PRIMARY KEY (`id`),
  key search_city (search,city),
  key company (company)
) ENGINE=InnoDB AUTO_INCREMENT=8473 DEFAULT CHARSET=utf8;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æˆªæ­¢åˆ°ç°åœ¨ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†æŠ“å–å­˜å‚¨è¿‡ç¨‹ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬è¦æ€ä¹ˆå»åˆ†æè¿™äº›æ•°æ®å‘¢ï¼Ÿ
æˆ‘å½“æ—¶æ˜¯æœ‰ç‚¹æ‡µé€¼çš„ã€‚å­å“§å­å“§å†™å®Œäº†ä»£ç ï¼Œæ•°æ®ä¹Ÿåšå¥½äº†å­˜å‚¨ï¼Œæ©ï¼Œç„¶åä¸çŸ¥é“è¦åšä»€ä¹ˆäº†â•®(â•¯_â•°)â•­ã€‚ç„¶åæˆ‘æƒ³èµ·äº†&lt;code class=&quot;highlighter-rouge&quot;&gt;ELK&lt;/code&gt;ã€‚&lt;/p&gt;

&lt;p&gt;ä»€ä¹ˆæ˜¯ELKï¼Œç®€å•æ¥è¯´å°±æ˜¯ç”±&lt;code class=&quot;highlighter-rouge&quot;&gt;elasticsearch&lt;/code&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;logstash&lt;/code&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;kibanna&lt;/code&gt;ä¸‰è€…æ„æˆ
&lt;code class=&quot;highlighter-rouge&quot;&gt;elasticsearch&lt;/code&gt;ï¼š å¼ºå¤§çš„å…¨æ–‡æ£€ç´¢å¼•æ“&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;logstash&lt;/code&gt;ï¼šå¼ºå¤§çš„æ—¥å¿—æ”¶é›†å·¥å…·&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;kibanna&lt;/code&gt; ï¼šæä¾›å¤šç§å¯è§†åŒ–ç®¡ç†å’Œæ•°æ®åˆ†æçš„å·¥å…·&lt;/p&gt;

&lt;p&gt;æœ‰äº†è¿™ä¸ªä¸œè¥¿æ˜¯ä¸æ˜¯å°±é¡¿æ—¶å¥½ç©äº†ï¼Œ0æˆæœ¬æ­å»ºèµ·è‡ªå·±çš„æ•°æ®åˆ†æå¹³å°ï¼ˆæ˜¯ä¸æ˜¯ä¸ä¸“ä¸šï¼Œå—¯ï¼Œç¡®å®ä¸ä¸“ä¸šğŸ˜…ï¼‰
ä½†æ˜¯å¾ˆä¹…ä¹‹å‰å°±æƒ³äº†è§£ä¸‹è¿™å‡ ä¸ªä¸œè¥¿äº†ï¼Œæ‰€ä»¥èµ¶ç´§åŠ¨æ‰‹æ­ä¸€ä¸ªèµ·æ¥å§ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;æ­å»ºELKç¯å¢ƒ&lt;/strong&gt;
ç›´æ¥å»&lt;a href=&quot;https://www.elastic.co/&quot;&gt;ELK&lt;/a&gt;è·å–å®‰è£…åŒ…ï¼Œå¹¶å®‰è£…ã€‚&lt;/p&gt;

&lt;p&gt;å¯åŠ¨logstashæœåŠ¡&lt;/p&gt;
&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# /usr/local/logstash-5.4.1/config/lagou.conf ä»¥æ­¤é…ç½®å¯åŠ¨logstash é…ç½®ç»†èŠ‚è§åæ–‡&lt;/span&gt;
/usr/local/logstash-5.4.1/bin/logstash -f /usr/local/logstash-5.4.1/config/lagou.conf
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

</description>
        <pubDate>Fri, 16 Jun 2017 19:00:00 +0800</pubDate>
        <link>https://yibingyi.github.io/learn/tool/2017/06/16/elk-1.html</link>
        <guid isPermaLink="true">https://yibingyi.github.io/learn/tool/2017/06/16/elk-1.html</guid>
        
        
        <category>learn</category>
        
        <category>tool</category>
        
      </item>
    
  </channel>
</rss>

<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Work Life</title>
    <description>å­¦ä¹  åˆ†äº« åšæŒ</description>
    <link>https://yibingyi.github.io/</link>
    <atom:link href="https://yibingyi.github.io/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Sat, 17 Jun 2017 04:21:08 +0800</pubDate>
    <lastBuildDate>Sat, 17 Jun 2017 04:21:08 +0800</lastBuildDate>
    <generator>Jekyll v3.4.3</generator>
    
      <item>
        <title>expect shell auto ssh</title>
        <description>&lt;p&gt;å…ˆè¯´è¯´èƒŒæ™¯ï¼Œåœ¨ç°åœ¨çš„å·¥ä½œç¯å¢ƒä¸­ï¼Œæ¯æ¬¡éœ€è¦ç™»é™†çº¿ä¸Šæœºå™¨çš„æ—¶å€™ï¼Œç¬¬ä¸€æ­¥éœ€è¦åˆ°å ¡å’æœº[PIN+Token]ï¼Œç¬¬äºŒæ­¥åœ¨ç™»é™†åˆ°ä¸­æ§æœºï¼Œå¹¶ä¸”éœ€è¦å®Œæˆè§’è‰²åˆ‡æ¢ç­‰æ“ä½œï¼Œæ¯”è¾ƒç¹çï¼Œäºæ˜¯æƒ³åˆ°æ˜¯å¦èƒ½è‡ªåŠ¨å®Œæˆå‘¢ï¼Ÿäºæ˜¯å‘ç°äº†expectè¿™ä¸ªä¸œè¥¿ï¼å¾ˆæƒŠå–œï¼ï¼ˆè¯·åŸè°…å°ç™½çš„æ— çŸ¥ï¼‰&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;å…ˆè¯´è¯´ä»€ä¹ˆæ˜¯&lt;a href=&quot;http://linuxcommand.org/man_pages/expect1.html&quot;&gt;expect shell?&lt;/a&gt;&lt;/strong&gt; &lt;br /&gt;
 å®˜æ–¹è§£é‡Šä¸ºï¼Œä¸€ç§ç”¨æ¥å’Œåº”ç”¨ç¨‹åºäº¤äº’çš„è„šæœ¬ï¼Œä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸‹expectè„šæœ¬çš„ç®€å•ä¾‹å­ï¼Œé¦–å…ˆè¦æ˜ç™½expectä¸æ˜¯bashçš„ä¸€ä¸ªå‘½ä»¤ï¼Œå®ƒä¹Ÿæ˜¯ä¸€ç§shellï¼Œæ²¡æœ‰å®‰è£…è¿‡ï¼Œç‚¹å‡»&lt;a href=&quot;http://expect.sourceforge.net/&quot;&gt;å®‰è£…Expect&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;SSHåˆçª¥Expect Shell&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# è¿™ä¸€è¡Œå‘Šè¯‰æ“ä½œç³»ç»Ÿè„šæœ¬é‡Œçš„ä»£ç ä½¿ç”¨é‚£ä¸€ä¸ªshellæ¥æ‰§è¡Œã€‚ç±»æ¯”bash&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#!/usr/bin/expect&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# è®¾ç½®å˜é‡&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;name map
&lt;span class=&quot;c&quot;&gt;# expect shell if&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;root&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    puts &lt;span class=&quot;s2&quot;&gt;&quot;WRRN: you will login as root;&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# spawn æ˜¯expect shellçš„ä¸€ä¸ªå‘½ä»¤ ç”¨æ¥å‘èµ·ä¸€ä¸ªäº¤äº’åŠ¨ä½œ æ¯”å¦‚ç°åœ¨å°±æ˜¯åœ¨è¿›è¡Œä¸€æ¬¡ssh&lt;/span&gt;
spawn ssh &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;@host.name
&lt;span class=&quot;c&quot;&gt;# æ­¤å¤„expecté’ˆå¯¹spawnæ‰§è¡ŒåŠ¨ä½œçš„è¿”å›å€¼åšä¸åŒçš„æ“ä½œ&lt;/span&gt;
expect &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# å¦‚æœè¿”å›çš„å­—ç¬¦ä¸²åŒ…å«(yes/no)&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&quot;(yes/no)?&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;# å‘é€yeså¹¶å›è½¦ ç›¸å½“äºæˆ‘ä»¬åœ¨terminalä¸­è¾“å…¥äº†yeså¹¶å›è½¦&lt;/span&gt;
        send &lt;span class=&quot;s2&quot;&gt;&quot;yes&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;# å¦‚æœè¿”å›çš„å­—ç¬¦ä¸²åŒ…å«password&lt;/span&gt;
        expect &lt;span class=&quot;s2&quot;&gt;&quot;password:&quot;&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;# å‘é€pwdTokenå¹¶å›è½¦ ç›¸å½“äºæˆ‘ä»¬åœ¨terminalä¸­è¾“å…¥äº†pwdTokenå¹¶å›è½¦&lt;/span&gt;
        send &lt;span class=&quot;s2&quot;&gt;&quot;pwdToken&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# åŒç† ä¸èµ˜è¿°&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&quot;password:&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;c&quot;&gt;# å‘å‡ºè¯·æ±‚è®©ç”¨æˆ·è¾“å…¥&lt;/span&gt;
            send_user &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;33&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;4;34m please input otp password : &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;33&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;0m &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
            &lt;span class=&quot;c&quot;&gt;# æ¥æ”¶ç”¨æˆ·æŒ‰ä¸‹å›è½¦é”®ä¹‹å‰è¾“å…¥çš„æ‰€æœ‰å­—ç¬¦&lt;/span&gt;
            expect_user -re &lt;span class=&quot;s2&quot;&gt;&quot;(.*)&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
            &lt;span class=&quot;c&quot;&gt;# å°†1111å’Œç”¨æˆ·è¾“å…¥æ‹¼æ¥èµ‹å€¼ç»™å˜é‡pwdToken&lt;/span&gt;
            &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;pwdToken 1111&lt;span class=&quot;nv&quot;&gt;$expect_out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1,string&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
            send &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$pwdToken&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# expect æ‰§è¡Œå®Œæˆ å°†æ§åˆ¶æƒäº¤å›ç»™ç»ˆç«¯&lt;/span&gt;
interact

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;trcks&lt;/strong&gt;
å¦‚æœåœ¨ç¼–å†™expectè„šæœ¬çš„æ—¶å€™é‡åˆ°äº†é—®é¢˜ï¼Œå¯ä»¥è¾“å…¥å‘½ä»¤&lt;code class=&quot;highlighter-rouge&quot;&gt;expect&lt;/code&gt;è¿›è¡Œè°ƒè¯•&lt;/p&gt;
&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;âœ  GitHub expect
&lt;span class=&quot;gp&quot;&gt;expect1.1&amp;gt; &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;name china
china
&lt;span class=&quot;gp&quot;&gt;expect1.2&amp;gt; &lt;/span&gt;puts &lt;span class=&quot;nv&quot;&gt;$name&lt;/span&gt;
china
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
</description>
        <pubDate>Fri, 16 Jun 2017 23:00:00 +0800</pubDate>
        <link>https://yibingyi.github.io/learn/tool/2017/06/16/learn-expect.html</link>
        <guid isPermaLink="true">https://yibingyi.github.io/learn/tool/2017/06/16/learn-expect.html</guid>
        
        
        <category>learn</category>
        
        <category>tool</category>
        
      </item>
    
      <item>
        <title>disqus è¢«å¢™äº†</title>
        <description>&lt;p&gt;åªèƒ½ç”¨&lt;code class=&quot;highlighter-rouge&quot;&gt;ç•…è¨€&lt;/code&gt;äº†ï¼Œä½†æ˜¯&lt;code class=&quot;highlighter-rouge&quot;&gt;ç•…è¨€&lt;/code&gt;åªèƒ½ç”¨15å¤©ï¼ŒğŸ˜”
çœ‹èµ·æ¥ä¹Ÿä¸æ˜¯é‚£ä¹ˆå®Œç¾&lt;/p&gt;
</description>
        <pubDate>Fri, 16 Jun 2017 19:00:00 +0800</pubDate>
        <link>https://yibingyi.github.io/learn/tool/2017/06/16/learn-first.html</link>
        <guid isPermaLink="true">https://yibingyi.github.io/learn/tool/2017/06/16/learn-first.html</guid>
        
        
        <category>learn</category>
        
        <category>tool</category>
        
      </item>
    
  </channel>
</rss>
